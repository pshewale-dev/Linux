#!/bin/bash

# Input file containing the list of servers (one per line)
input_file="server_list.txt"

# Output CSV file
output_file="server_output.csv"

# SSH username
username="your_username"

# Telnet function over SSH
ssh_telnet_server() {
    local server=$1
    local port=$2
    # Replace the command below with your desired telnet command
    # Example: ssh $username@$server "telnet $server $port"
    ssh $username@$server "telnet $server $port" 2>&1
}

# SSH ping function
ssh_ping_server() {
    local server=$1
    # Replace the command below with your desired ping command
    # Example: ssh $username@$server "ping -c 4 $server"
    ssh $username@$server "ping -c 4 $server" 2>&1
}

# Create or truncate the output CSV file
echo "Server, Telnet 80, Telnet 8443, Ping" > $output_file

# Read each server from the input file
while IFS= read -r server; do
    telnet_80=$(ssh_telnet_server "$server" 80)
    telnet_8443=$(ssh_telnet_server "$server" 8443)
    ping_output=$(ssh_ping_server "$server")
    echo "$server, \"$telnet_80\", \"$telnet_8443\", \"$ping_output\"" >> $output_file
done < "$input_file"

